# Wall2CAD MVP - 최소 기능 제품 명세서

## 1. MVP 목표

### 1.1 핵심 가치 검증
- SAM 기반 자동 세그멘테이션의 실용성 검증
- 이미지→벡터→DXF 변환 워크플로우의 유효성 확인
- 사용자 피드백을 통한 핵심 니즈 파악

### 1.2 제품 형태 요구사항
- **독립 실행 프로그램**: 노트북(.ipynb) 환경이 아닌 일반 사용자용 애플리케이션
- **GUI 기반 워크플로우**: 코드 실행 없이 클릭만으로 전체 과정 완료
- **설치형 소프트웨어**: 복잡한 개발 환경 설정 없이 바로 실행 가능

### 1.3 성공 지표
- 기본 변환 성공률 80% 이상
- 사용자 완주율 70% 이상 (이미지 로드 → DXF 저장)
- 평균 처리 시간 5분 이하 (일반적인 이미지 기준)

## 2. MVP 범위

### 2.1 포함 기능 (Must Have)
✅ **이미지 로딩**
- 단일 이미지 지원 (JPG, PNG)
- 드래그 앤 드롭
- 기본 이미지 표시

✅ **SAM 세그멘테이션**
- vit_h 모델 고정 사용
- 기본 파라미터 고정
- 진행률 표시

✅ **결과 확인**
- 원본 이미지 + 벡터 오버레이
- 간단한 확대/축소
- 마스크 개수 표시

✅ **DXF 내보내기**
- 기본 DXF R2010 형식
- 좌표계 자동 설정
- 저장 위치 선택

✅ **기본 UI**
- 단일 윈도우 구조
- 파일 메뉴 (열기, 저장, 종료)
- 상태바 (진행상황)

### 2.2 제외 기능 (Nice to Have)
❌ **고급 편집 기능**
- 벡터 수동 편집
- 개별 마스크 선택/삭제
- 파라미터 실시간 조정

❌ **배치 처리**
- 여러 파일 동시 처리
- 폴더 단위 처리

❌ **고급 뷰포트**
- 정밀한 확대/축소
- 측정 도구
- 그리드 표시

❌ **설정 관리**
- 사용자 환경설정
- 모델 선택 옵션

## 3. MVP 기술 스택 (간소화)

### 3.1 핵심 라이브러리
- **PyQt5**: UI (PyQt6보다 안정성 우선)
- **PyTorch**: SAM 모델
- **OpenCV**: 이미지 처리
- **ezdxf**: DXF 생성
- **matplotlib**: 기본 시각화

### 3.2 제외 기술
- PyOpenGL (복잡한 2D 렌더링 제외)
- 복잡한 비동기 처리
- 고급 메모리 최적화

## 4. MVP UI 설계 (단순화)

```
+----------------------------------------+
| File | Help                            |
+----------------------------------------+
|  [Load Image]     [Export DXF]        |
+----------------------------------------+
|                                        |
|        Image Display Area              |
|        (matplotlib widget)             |
|                                        |
+----------------------------------------+
| Status: Ready / Processing... / Done   |
+----------------------------------------+
```

### 4.1 사용자 플로우
1. **앱 실행** → 빈 화면
2. **"Load Image" 클릭** → 파일 선택 다이얼로그
3. **이미지 선택** → 자동 SAM 처리 시작
4. **처리 완료** → 결과 화면 표시
5. **"Export DXF" 클릭** → 저장 위치 선택
6. **저장 완료** → 성공 메시지

## 5. MVP 개발 일정 (3주 - 프로그램 빌드 포함)

### Week 1: 핵심 로직
- **Day 1-2**: 프로젝트 구조 및 SAM 통합
- **Day 3-4**: 이미지 로딩 및 처리 파이프라인
- **Day 5**: DXF 변환 로직

### Week 2: UI 및 통합
- **Day 1-2**: 기본 PyQt5 UI 구현
- **Day 3-4**: 전체 워크플로우 연결
- **Day 5**: 기본 테스트 및 버그 수정

### Week 3: 프로그램 패키징 (추가)
- **Day 1-2**: PyInstaller 빌드 설정 및 최적화
- **Day 3**: 설치 프로그램 (NSIS) 스크립트 작성
- **Day 4**: 배포 테스트 (다양한 Windows 환경)
- **Day 5**: 최종 버그 수정 및 배포 준비

## 6. MVP 파일 구조

```
mvp_wall2cad/
├── main.py              # 애플리케이션 진입점
├── ui_main.py           # 메인 윈도우 (단일 파일)
├── sam_processor.py     # SAM 처리 로직
├── dxf_converter.py     # DXF 변환 로직
├── requirements.txt     # 의존성 목록
└── models/              # SAM 모델 파일
    └── sam_vit_h_4b8939.pth
```

## 7. MVP 핵심 클래스

### 7.1 MainWindow (ui_main.py)
```python
class MainWindow(QMainWindow):
    def __init__(self):
        # UI 초기화
        # 이미지 표시 위젯
        # 버튼 연결
    
    def load_image(self):
        # 파일 다이얼로그
        # SAM 처리 시작
    
    def export_dxf(self):
        # DXF 저장 다이얼로그
```

### 7.2 SAMProcessor (sam_processor.py)
```python
class SAMProcessor:
    def __init__(self):
        # 모델 로드 (앱 시작시 1회)
    
    def process_image(self, image_path):
        # 이미지 → 마스크 변환
        # 진행률 시그널 발생
```

### 7.3 DXFConverter (dxf_converter.py)
```python
class DXFConverter:
    def masks_to_dxf(self, masks, image_shape, output_path):
        # 마스크 → 윤곽선 → DXF
```

## 8. MVP 제약사항

### 8.1 성능 제약
- **이미지 크기**: 최대 2048x2048
- **처리 시간**: 최대 10분 허용
- **메모리 사용**: 8GB 이하

### 8.2 기능 제약
- **파일 포맷**: JPG, PNG만 지원
- **SAM 설정**: 기본값 고정, 조정 불가
- **DXF 옵션**: 단일 형식만 지원
- **에러 처리**: 기본 메시지박스만

### 8.3 UI 제약
- **창 크기**: 고정 크기 (800x600)
- **확대/축소**: 기본 matplotlib 도구만
- **다국어**: 영어만 지원

## 9. MVP 테스트 시나리오

### 9.1 기본 워크플로우
1. ✅ 앱 실행 → 정상 시작
2. ✅ 이미지 로드 → 표시 확인
3. ✅ 자동 처리 → 진행률 표시
4. ✅ 결과 확인 → 벡터 오버레이
5. ✅ DXF 저장 → 파일 생성

### 9.2 에러 시나리오
1. ✅ 잘못된 파일 → 에러 메시지
2. ✅ 메모리 부족 → 경고 메시지
3. ✅ 저장 실패 → 재시도 옵션

### 9.3 성능 테스트
1. ✅ 소형 이미지 (512x512) → 1분 이내
2. ✅ 중형 이미지 (1024x1024) → 3분 이내
3. ✅ 대형 이미지 (2048x2048) → 10분 이내

## 10. MVP 배포 전략

### 10.1 배포 형태 (프로그램 요구사항 반영)
- **독립 실행파일**: wall2cad.exe (PyInstaller 빌드)
- **원클릭 설치**: Setup.exe 설치 프로그램 (NSIS)
- **포터블 버전**: ZIP 압축 배포 (dependencies 포함)

#### 프로그램 형태 특징
- ✅ Python 환경 설치 불필요
- ✅ 의존성 라이브러리 자동 포함
- ✅ 바탕화면 바로가기 자동 생성
- ✅ Windows 시작 메뉴 등록
- ✅ 파일 연결 (.jpg, .png → Wall2CAD로 열기)

### 10.2 시스템 요구사항
- **OS**: Windows 10+ (우선 지원)
- **RAM**: 8GB 이상
- **GPU**: CUDA 지원 (선택사항)
- **저장공간**: 3GB 이상

### 10.3 사용자 가이드 (프로그램 형태)
```
설치:
1. Wall2CAD_Setup.exe 다운로드 및 실행
2. 설치 마법사 따라 진행 (기본 설정 권장)
3. 바탕화면 바로가기 생성 완료

사용:
1. 바탕화면 Wall2CAD 아이콘 더블클릭
2. "Load Image" 버튼으로 이미지 선택
3. 자동 처리 완료까지 대기 (진행률 표시)
4. "Export DXF" 버튼으로 결과 저장
5. AutoCAD 등에서 DXF 파일 열기

또는: 이미지 파일 우클릭 → "Wall2CAD로 열기"
```

## 11. MVP 이후 계획

### 11.1 수집할 피드백
- 처리 속도 만족도
- 결과 품질 평가
- 워크플로우 사용성
- 가장 필요한 추가 기능

### 11.2 우선순위 기능
1. **파라미터 조정**: 품질 vs 속도
2. **벡터 편집**: 결과 수정 기능
3. **배치 처리**: 생산성 향상
4. **고급 뷰포트**: CAD 스타일 UI

### 11.3 확장 방향
- 노트북의 자동 배치 처리 로직 통합
- 웹 기반 경량 버전 검토
- 클라우드 처리 옵션 검토

---

**MVP 개발 시작 준비 완료**  
**예상 개발 기간**: 2주  
**핵심 검증 목표**: 기본 워크플로우 사용성  
**성공 지표**: 이미지→DXF 변환 완주율 70%+